<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Optimize scans - Codename SCNR Documentation</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../index.html">Introduction</a></li><li class="chapter-item expanded affix "><a href="../installation.html">Installation</a></li><li class="chapter-item expanded affix "><a href="../system-requirements.html">System requirements</a></li><li class="chapter-item expanded affix "><li class="part-title">Deployment</li><li class="chapter-item expanded "><a href="../deployment/direct.html"><strong aria-hidden="true">1.</strong> Direct</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../deployment/scripted.html"><strong aria-hidden="true">1.1.</strong> Scripted</a></li></ol></li><li class="chapter-item expanded "><a href="../deployment/distributed/index.html"><strong aria-hidden="true">2.</strong> Distributed</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../deployment/distributed/agent.html"><strong aria-hidden="true">2.1.</strong> Agent</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../deployment/distributed/agent/grid.html"><strong aria-hidden="true">2.1.1.</strong> Grid</a></li></ol></li><li class="chapter-item expanded "><a href="../deployment/distributed/scheduler.html"><strong aria-hidden="true">2.2.</strong> Scheduler</a></li></ol></li><li class="chapter-item expanded "><a href="../deployment/introspector/index.html"><strong aria-hidden="true">3.</strong> Introspector</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../deployment/introspector/ruby.html"><strong aria-hidden="true">3.1.</strong> Ruby</a></li><li class="chapter-item expanded "><a href="../deployment/introspector/java.html"><strong aria-hidden="true">3.2.</strong> Java</a></li><li class="chapter-item expanded "><a href="../deployment/introspector/dotnet.html"><strong aria-hidden="true">3.3.</strong> .NET</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">Interfaces</li><li class="chapter-item expanded "><a href="../interfaces/cli.html"><strong aria-hidden="true">4.</strong> CLI</a></li><li class="chapter-item expanded "><a href="../interfaces/ruby-api/index.html"><strong aria-hidden="true">5.</strong> Ruby API</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../interfaces/ruby-api/data/index.html"><strong aria-hidden="true">5.1.</strong> Data</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../interfaces/ruby-api/data/sitemap.html"><strong aria-hidden="true">5.1.1.</strong> Sitemap</a></li><li class="chapter-item expanded "><a href="../interfaces/ruby-api/data/urls.html"><strong aria-hidden="true">5.1.2.</strong> Urls</a></li><li class="chapter-item expanded "><a href="../interfaces/ruby-api/data/pages.html"><strong aria-hidden="true">5.1.3.</strong> Pages</a></li><li class="chapter-item expanded "><a href="../interfaces/ruby-api/data/issues.html"><strong aria-hidden="true">5.1.4.</strong> Issues</a></li></ol></li><li class="chapter-item expanded "><a href="../interfaces/ruby-api/state.html"><strong aria-hidden="true">5.2.</strong> State</a></li><li class="chapter-item expanded "><a href="../interfaces/ruby-api/browserpool.html"><strong aria-hidden="true">5.3.</strong> Browserpool</a></li><li class="chapter-item expanded "><a href="../interfaces/ruby-api/dom.html"><strong aria-hidden="true">5.4.</strong> Dom</a></li><li class="chapter-item expanded "><a href="../interfaces/ruby-api/http.html"><strong aria-hidden="true">5.5.</strong> Http</a></li><li class="chapter-item expanded "><a href="../interfaces/ruby-api/input.html"><strong aria-hidden="true">5.6.</strong> Input</a></li><li class="chapter-item expanded "><a href="../interfaces/ruby-api/logging.html"><strong aria-hidden="true">5.7.</strong> Logging</a></li><li class="chapter-item expanded "><a href="../interfaces/ruby-api/checks.html"><strong aria-hidden="true">5.8.</strong> Checks</a></li><li class="chapter-item expanded "><a href="../interfaces/ruby-api/plugins.html"><strong aria-hidden="true">5.9.</strong> Plugins</a></li><li class="chapter-item expanded "><a href="../interfaces/ruby-api/fingerprinters.html"><strong aria-hidden="true">5.10.</strong> Fingerprinters</a></li><li class="chapter-item expanded "><a href="../interfaces/ruby-api/scan/index.html"><strong aria-hidden="true">5.11.</strong> Scan</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../interfaces/ruby-api/scan/options.html"><strong aria-hidden="true">5.11.1.</strong> Options</a></li><li class="chapter-item expanded "><a href="../interfaces/ruby-api/scan/scope.html"><strong aria-hidden="true">5.11.2.</strong> Scope</a></li><li class="chapter-item expanded "><a href="../interfaces/ruby-api/scan/session.html"><strong aria-hidden="true">5.11.3.</strong> Session</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../interfaces/rest-api/index.html"><strong aria-hidden="true">6.</strong> REST API</a></li><li class="chapter-item expanded "><a href="../interfaces/web/index.html"><strong aria-hidden="true">7.</strong> Web UI</a></li><li class="chapter-item expanded affix "><li class="part-title">How to</li><li class="chapter-item expanded "><a href="../how-to/generate-reports.html"><strong aria-hidden="true">8.</strong> Generate reports</a></li><li class="chapter-item expanded "><a href="../how-to/optimize-scans.html" class="active"><strong aria-hidden="true">9.</strong> Optimize scans</a></li><li class="chapter-item expanded "><a href="../how-to/maintain-a-valid-session.html"><strong aria-hidden="true">10.</strong> Maintain a valid session</a></li><li class="chapter-item expanded "><a href="../how-to/scan-services.html"><strong aria-hidden="true">11.</strong> Scan services</a></li><li class="chapter-item expanded "><a href="../how-to/scale.html"><strong aria-hidden="true">12.</strong> Scale</a></li><li class="chapter-item expanded affix "><a href="../COPYING.html">Copyright</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Codename SCNR Documentation</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="optimize-scans"><a class="header" href="#optimize-scans">Optimize scans</a></h1>
<p>Left to its own devices, Codename SCNR will try to optimize itself to match any given
circumstance, but there are limitations to what it can do automatically.</p>
<p>If a scan is taking too long, chances are that there are ways to make it go much
faster by taking a couple of minutes to configure the system to closer match your needs.</p>
<p>In addition to performance, the following options also affect resource usage so
you can experiment with them to better match your available resources as well.</p>
<ol>
<li><a href="#only-enable-security-checks-that-concern-you">Only enable security checks that concern you</a></li>
<li><a href="#tailor-the-audit-process-to-the-platforms-of-the-web-application">Tailor the audit process to the platforms of the web application</a></li>
<li><a href="#ensure-server-responsiveness">Ensure server responsiveness</a></li>
<li><a href="#balance-ram-consumption-and-performance">Balance RAM consumption and performance</a></li>
<li><a href="#reduce-ram-consumption-by-avoiding-large-resources">Reduce RAM consumption by avoiding large resources</a></li>
<li><a href="#dont-follow-redundant-pages">Don’t follow redundant pages</a></li>
<li><a href="#adjust-the-amount-of-browser-workers">Adjust the amount of browser workers</a></li>
<li><a href="#pick-the-audit-mode-that-suits-you-best">Pick the audit mode that suits you best</a></li>
<li><a href="#scan-incrementally">Scan incrementally</a></li>
</ol>
<h2 id="only-enable-security-checks-that-concern-you"><a class="header" href="#only-enable-security-checks-that-concern-you">Only enable security checks that concern you</a></h2>
<p>By default, SCNR will load <strong>all</strong> checks, which may not be what you want.</p>
<p>If you are interested in high severity vulnerabilities or don’t care for things
like discovery of common files and directories, and the like, you should disable
the superfluous checks.</p>
<p>You can enable only <code>active</code> checks with:</p>
<pre><code>--checks=active/* 
</code></pre>
<p>Or skip the inefficient <code>passive</code> ones with:</p>
<pre><code>--checks=*,-common_*,-backup_*,-backdoors
</code></pre>
<h2 id="tailor-the-audit-process-to-the-platforms-of-the-web-application"><a class="header" href="#tailor-the-audit-process-to-the-platforms-of-the-web-application">Tailor the audit process to the platforms of the web application</a></h2>
<p>By default, the system will fingerprint the web application in order to deduce
what platforms power it, thus enabling it to only send applicable payloads
(instead of everything) which results in less server stress and bandwidth usage.</p>
<p>However, it is a good idea to explicitly set the platforms, if you know them,
so as to play it safe and get the best possible results – especially since
database platforms can’t be fingerprinted prior to the audit and their payloads
are a large part of the overall scan.</p>
<p>You can specify platforms with:</p>
<pre><code>--platforms=linux,mysql,php,apache
</code></pre>
<h2 id="ensure-server-responsiveness"><a class="header" href="#ensure-server-responsiveness">Ensure server responsiveness</a></h2>
<p>By default, SCNR will monitor the response times of the server and throttle
itself down if it detects that the server is getting stressed.
This happens in order to keep the server alive and responsive and maintain a
stable connection to it.</p>
<p>However, there are times with weak servers when they die before SCNR gets a
chance to adjust itself.</p>
<p>You can bring up the scan statistics on the CLI screen by hitting <code>Enter</code>, in
which case you’ll see something like:</p>
<pre><code> [~] Currently auditing          http://testhtml5.vulnweb.com/ajax/popular?offset=0                                 
 [~] Burst response time sum     6.861 seconds                                                                      
 [~] Burst response count        29                                                                                 
 [~] Burst average response time 1.759 seconds                                                                      
 [~] Burst average               0 requests/second                                                              
 [~] Original max concurrency    10                                                                                 
 [~] Throttled max concurrency   2                                                                                                                                             
</code></pre>
<p>We can see that the server is having a hard time from the following values:</p>
<ul>
<li>Burst average: 3 requests/second</li>
<li>Burst average response time  1.759</li>
<li>Burst average: 0 requests/second</li>
<li>Throttled max concurrency: 2</li>
</ul>
<p>The response times were so high (1.75 seconds) that SCNR had to throttle its
HTTP request concurrency from 10 requests to 2 requests, which would result in a
drastically increased scan time.</p>
<p>You can lower the default HTTP concurrency and try again to make sure that the
server at no point gets a stressful load:</p>
<pre><code>--http-request-concurrency=5
</code></pre>
<h2 id="balance-ram-consumption-and-performance"><a class="header" href="#balance-ram-consumption-and-performance">Balance RAM consumption and performance</a></h2>
<p>Most excessive RAM consumption issues are caused by large (or a lot of) HTTP requests,
which need to be temporarily stored in memory in order for them to later be scheduled
in a way that achieves optimal network concurrency.</p>
<p>To cut this short, having a lot of HTTP requests in the queue allows SCNR to
be better at performing a lot of them at the same time, and thus makes better
use of your available bandwidth. So, a large queue means better network performance.</p>
<p>However, a large queue can lead to some serious RAM consumption, depending on
the website and type of audit and a lot of other factors.</p>
<p>As a compromise between preventing RAM consumption issues but still getting
decent performance, the default queue size is set to <code>50</code>.
You can adjust this number to better suit your needs depending on the situation.</p>
<p>You can adjust the HTTP request queue size via the <code>--http-request-queue-size</code> option.</p>
<h2 id="reduce-ram-consumption-by-avoiding-large-resources"><a class="header" href="#reduce-ram-consumption-by-avoiding-large-resources">Reduce RAM consumption by avoiding large resources</a></h2>
<p>SCNR performs a large number of analysis operations on each web page.
This is usually not a problem, except for when dealing with web pages of large sizes.</p>
<p>If you are in a RAM constrained environment, you can configure SCNR to not
download and analyze pages which exceed a certain size limit – by default, that
limit is 500KB.</p>
<p>You can adjust the maximm allows size of HTTP response via the <code>--http-response-max-size</code> option.</p>
<h2 id="dont-follow-redundant-pages"><a class="header" href="#dont-follow-redundant-pages">Don’t follow redundant pages</a></h2>
<p>A lot of websites have redundant pages like galleries, calendars, directory
listings etc. which are basically the same page with the same inputs but just
presenting different data.</p>
<p>Auditing the first (or first few) of such pages is
often enough and trying to follow and audit them all can sometimes result in an
infinite crawl, as can be the case with calendars.</p>
<p>SCNR provides 2 features to help deal with that:</p>
<ul>
<li>Redundancy filters: Specify <code>pattern</code> and <code>counter</code> pairs, pages matching the
<code>pattern</code> will be followed the amount of times specified by the <code>counter</code>.
<ul>
<li><code>--scope-redundant-path-pattern</code></li>
</ul>
</li>
<li>Auto-redundant: Follow URLs with the same combinations of query parameters a
limited amount of times.
<ul>
<li><code>--scope-auto-redundant</code> – Default is <code>10</code>.</li>
</ul>
</li>
</ul>
<h2 id="adjust-the-amount-of-browser-workers"><a class="header" href="#adjust-the-amount-of-browser-workers">Adjust the amount of browser workers</a></h2>
<p>SCNR uses real browsers to support technologies such as HTML5, AJAX and DOM
manipulation and perform deep analysis of client-side code.</p>
<p>Even though browser operations are performed in parallel using a pool of workers,
the default pool size is modest and operations can be time consuming.</p>
<p>By increasing the amount of workers in the pool, scan durations can be dramatically shortened,
especially when scanning web applications that make heavy use of client-side technologies.</p>
<p>Finding the optimal pool size depends on the resources of your machine (especially
the amount of CPU cores) and will probably require some experimentation; on average,
1-2 browsers for each logical CPU core serves as a good starting point.</p>
<p>However, do keep in mind that more workers may lead to higher RAM consumption as
they will also accelerate workload generation.</p>
<p>You can set this option via <code>--dom-pool-size</code>.
The default is calculated based on the amount of available CPU cores your system has.</p>
<h2 id="pick-the-audit-mode-that-suits-you-best"><a class="header" href="#pick-the-audit-mode-that-suits-you-best">Pick the audit mode that suits you best</a></h2>
<p>This is a <em>Time</em> vs <em>Thoroughness</em> balancing option.</p>
<p><code>--audit-mode</code>:</p>
<ul>
<li><code>quick</code> – For a quick scan, complex or rare payloads will be omitted.</li>
<li><code>moderate</code> (default) – Balanced payloads.</li>
<li><code>super</code> – All payloads, more DOM probing, disabled attack optimization heuristics.</li>
</ul>
<h2 id="scan-incrementally"><a class="header" href="#scan-incrementally">Scan incrementally</a></h2>
<p>In order to save valuable time on subsequent scans, Codename SCNR allows you to extract a session file from
completed/aborted scans, in order to allow for incremental re-scans.</p>
<p>This means that only newly introduced input vectors will be audited the next time around, which can save immense amounts
of time.</p>
<p>The location of the session file is printed at the end of each scan and can be restored via:</p>
<pre><code>./bin/scnr_restore SESSION_FILE
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../how-to/generate-reports.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../how-to/maintain-a-valid-session.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../how-to/generate-reports.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../how-to/maintain-a-valid-session.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
